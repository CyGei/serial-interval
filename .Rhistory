mean = 4
sd = 0.1
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
d<- dnorm(x, mean = mean, sd = sd)
d
plot(d, type = "l")
plot(x,d, type = "l")
View(d)
d
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 4
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 0
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 1
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
#dotted lines are now split in equal probabilities -- OK
#we now want to know what x points these are on the distribution
# using qnorms
strata
df
df %>%
group_by(samp) %>%
mutate(lag.q = dplyr::lag(q, n = 1, default = NA))
df
strata %>%
group_by(samp) %>%
mutate(lag.q = dplyr::lag(q, n = 1, default = NA))
strata %>%
group_by(samp) %>%
mutate(lag.q = dplyr::lead(q, n = 1, default = NA))
for (i in 2:nrow(strata)) {
print(i)
}
for (i in 2:nrow(strata)) {
print(i)
upper_val[i] = strata$q[i+1]
}
upper_val<- vector()
for (i in 2:nrow(strata)) {
print(i)
upper_val[i] = strata$q[i+1]
}
upper_val
strata
strata
strata
upper_val
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] = strata$q[i+1]
}
strata
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
strata$q[i+1]
strata$upper_val[i]
strata$upper_val <- ""
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
strata
strata$upper_val <- NA
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
strata
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 1
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
strata
strata$upper_val <- NA
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
strata
fig <- fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
fig
strata
fig+
geom_rect(data = strata,
aes(xmin = q, xmax = upper_val, col = samp))
fig+
geom_rect(data = strata,
aes(xmin = q, xmax = upper_val, ymin = 0, ymax = 1,
col = samp))
fig+
geom_rect(data = strata,
aes(xmin = q, xmax = upper_val, ymin = rep(0, nrow(strata)), ymax = rep(1, nrow(strata)),
col = samp))
fig+
geom_rect(data = strata,
aes(xmin = q, xmax = upper_val,
ymin = rep(0, nrow(strata)),
ymax = rep(1, nrow(strata)),
col = samp))
fig
strata
strata[1]
strata[1,]
strata
strata[1,]$q <- 1.1262063
strata[1,]$q <- 1.1262062
fig+
geom_rect(data = strata,
aes(xmin = q, xmax = upper_val,
ymin = rep(0, nrow(strata)),
ymax = rep(1, nrow(strata)),
col = samp))
strata
strata <- data.frame(samp, q)
strata$upper_val <- NA
for (i in 2:nrow(strata)) {
print(i)
strata$upper_val[i] <-  strata$q[i+1]
}
strata
strata[1,]$q <- 1.1262062
strata[1,]$q <- -1.1262062
strata[1,]$upper_val <- 1.126200
strata
fig+
geom_rect(data = strata,
aes(xmin = q, xmax = upper_val,
ymin = rep(0, nrow(strata)),
ymax = rep(1, nrow(strata)),
col = samp))
strata[-c(1,11)]
strata[-c(1,11),]
fig+
geom_rect(data = strata[-c(1,11),],
aes(xmin = q, xmax = upper_val,
ymin = rep(0, nrow(strata[-c(1,11),])),
ymax = rep(1, nrow(strata[-c(1,11),])),
col = samp))
fig
df
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 1
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig <- fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
fig
q
n
strata
strata$lower_q <- q
strata %>% mutate(upper_q = lead(q))
strata
strata %>% mutate(upper_q = lead(q))
cut(strata$q)
cut(strata$q, breaks = 10)
strata<- strata %>% mutate(lower_q = q,
upper_q = lead(q))
strata
runif(1, min = strata$lower_q, strata$upper_q)
for (i in 1:nrow(strata)) {
r <- runif(1, min = strata$lower_q[i], strata$upper_q[i])
print(i)
print(r)
}
strata
r<- vector()
for (i in 1:nrow(strata)) {
r[i] <- runif(1, min = strata$lower_q[i], strata$upper_q[i])
}
r
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 1
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
df
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
fig <- fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
fig
x<- seq(0,8, by = 0.1)
n <- seq(0,1, 0.1)
mean = 4
sd = 1
d<- dnorm(x, mean = mean, sd = sd)
p <- pnorm(x, mean = mean, sd = sd)
q <-  qnorm(n, mean = mean, sd = mean)
df <- data.frame(x, d, p)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
p
samp <- seq(0,1, 0.1) #10 samples
strata <- data.frame(samp, q)
strata <- data.frame(n, q)
strata
df <- data.frame(x, d, p)
strata <- data.frame(n, q)
fig <- df %>%
ggplot(aes(x = x )) +
geom_line(aes(y = d, col = "dnorm"))+
geom_line(aes(y = p, col = "pnorm"))+
scale_y_continuous(sec.axis = sec_axis(~., name = "p"))+
scale_colour_manual(values = c("blue", "red"))+
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
fig
fig <- fig +
geom_hline(data = strata,
aes(yintercept = samp), linetype = "dotted", col = "red")+
geom_vline(data = strata,
aes(xintercept = q), linetype = "dotted", col = "blue")+
scale_x_continuous(n.breaks = 10)
fig
q
strata<- strata %>% mutate(lower_q = q,
upper_q = lead(q))
strata
r<- vector()
for (i in 1:nrow(strata)) {
r[i] <- runif(1, min = strata$lower_q[i], strata$upper_q[i])
}
r #this is the parameter 1 sample point
randomLHS(1, 2)
randomLHS(10, 1)
# LHS package -------------------------------------------------------------
library(lhs)
A <- randomLHS(5, 4)
B <- matrix(nrow = nrow(A), ncol = ncol(A))
A <- randomLHS(5, 2)
B <- matrix(nrow = nrow(A), ncol = ncol(A))
B
A
B
min_mu = 4.9
min_sd = 2.2
max_mu = 6.7
max_sd = 5.2
B[,1] <- rtruncnorm(
A[, 1],
mean = median(min_mu:max_mu),
sd = median(min_sd:max_sd),
a = min_mu,
b = max_mu
) # mean distribution
B[,2]<- rtruncnorm(
A[, 1],
mean = median(min_cv:max_cv),
sd = median(min_sd:max_sd),
a = min_cv,
b = max_cv
) #cv distribution
min_cv <- min_sd/min_mu
max_cv <- max_sd/max_mu
B[,1] <- rtruncnorm(
A[, 1],
mean = median(min_mu:max_mu),
sd = median(min_sd:max_sd),
a = min_mu,
b = max_mu
) # mean distribution
B[,2]<- rtruncnorm(
A[, 1],
mean = median(min_cv:max_cv),
sd = median(min_sd:max_sd),
a = min_cv,
b = max_cv
) #cv distribution
B
graph2dLHSTransform <- function(Alhs, transform1, transform2, min1, max1, min2, max2)
{
stopifnot(ncol(Alhs) == 2)
stopifnot(all(Alhs[,1] <= max1 & Alhs[,1] >= min1))
stopifnot(all(Alhs[,2] <= max2 & Alhs[,2] >= min2))
sims <- nrow(Alhs)
breaks <- seq(0,1,length = sims + 1)[2:(sims)]
breaksTransformed1 <- sapply(breaks, transform1)
breaksTransformed2 <- sapply(breaks, transform2)
par(mar = c(4,4,2,2))
plot.default(Alhs[,1], Alhs[,2], type = "n",
ylim = c(min2, max2),
xlim = c(min1, max1),
xlab = "Parameter 1", ylab = "Parameter 2",
xaxs = "i", yaxs = "i", main = "")
for (si in 1:sims)
{
temp <- Alhs[si,]
for (i in 1:sims)
{
if ((i == 1 && min1 <= temp[1] && breaksTransformed1[i] >= temp[1]) ||
(i == sims && max1 >= temp[1] && breaksTransformed1[i - 1] <= temp[1]) ||
(breaksTransformed1[i - 1] <= temp[1] && breaksTransformed1[i] >= temp[1]))
{
for (j in 1:sims)
{
if ((j == 1 && min2 <= temp[2] && breaksTransformed2[j] >= temp[2]) ||
(j == sims && max2 >= temp[2] && breaksTransformed2[j - 1] <= temp[2]) ||
(breaksTransformed2[j - 1] <= temp[2] && breaksTransformed2[j] >= temp[2]))
{
if (i == 1)
{
xbot <- min1
xtop <- breaksTransformed1[i]
} else if (i == sims)
{
xbot <- breaksTransformed1[i - 1]
xtop <- max1
} else
{
xbot <- breaksTransformed1[i - 1]
xtop <- breaksTransformed1[i]
}
if (j == 1)
{
ybot <- min2
ytop <- breaksTransformed2[j]
} else if (j == sims)
{
ybot <- breaksTransformed2[j - 1]
ytop <- max2
} else
{
ybot <- breaksTransformed2[j - 1]
ytop <- breaksTransformed2[j]
}
rect(xbot, ybot, xtop, ytop, col = "grey")
}
}
}
}
}
points(Alhs[,1], Alhs[,2], pch = 19, col = "red")
abline(v = breaksTransformed1, h = breaksTransformed2)
}
graph2dLHSTransform(B)
max_cv
B[,1:2]
f <- function(x){rtruncnorm(x, a = min_mu, b = max_mu)}
g <- function(x){rtruncnorm(x, a = min_cv, b = max_cv)}
graph2dLHSTransform(B[,1:2], f, g, -4, 4, 0, 8)
B
graph2dLHSTransform(B[,1:2], f, g, 4, 7, 0, 1)
graph2dLHSTransform(B[,1:2], f, g, 4.9, 6.5, 0, 1)
r #this is the parameter 1 sample point
